---
title: "Zombies HW"
Author: Audrey Tjahjadi
output: html_document
---

```{r}
f<-"C:/Users/Audrey/Desktop/zombies.csv"
d<-read.csv(f)
head(d)
```

```{r}
muh<-(d$height)
meanh<-mean(muh)
meanh
varmuh <- function(muh) {
     sqrt(sum((muh - mean(muh))^2)/(length(muh)))
}
varmuh(muh)
```
```{r}
muw<-(d$weight)
meanw<-mean(muw)
meanw
varmuw <- function(muw) {
     sqrt(sum((muw - mean(muw))^2)/(length(muw)))
}
varmuw(muw)
```
```{r}
muy<-(d$years_of_education)
meany<-mean(muy)
meany
varmuy <- function(muy) {
     sqrt(sum((muy - mean(muy))^2)/(length(muy)))
}
varmuy(muy)
```
```{r}
muz<-(d$zombies_killed)
meanz<-mean(muz)
meanz
varmuz <- function(muz) {
     sqrt(sum((muz - mean(muz))^2)/(length(muz)))
}
varmuz(muz)
```
```{r}
mua<-(d$age)
meana<-mean(mua)
meana
varmua <- function(mua) {
     sqrt(sum((mua - mean(mua))^2)/(length(mua)))
}
varmua(mua)
```
```{r}
library(ggplot2)
p <- ggplot(data = d, aes(x = gender, y = height))
p <- p + geom_boxplot()
p <- p + theme(axis.text.x = element_text(angle = 90))
p <- p + ylab("Height")
p
```

```{r}
library(ggplot2)
p2 <- ggplot(data = d, aes(x = gender, y = weight))
p2 <- p2 + geom_boxplot()
p2 <- p2 + theme(axis.text.x = element_text(angle = 90))
p2 <- p2 + ylab("Weight")
p2
```

```{r}
library(ggplot2)
p3 <- ggplot(data = d, aes(x = gender, y = years_of_education))
p3 <- p3 + geom_boxplot()
p3 <- p3 + theme(axis.text.x = element_text(angle = 90))
p3 <- p3 + ylab("Years of Education")
p3
```

```{r}
library(ggplot2)
p4 <- ggplot(data = d, aes(x = gender, y = zombies_killed))
p4 <- p4 + geom_boxplot()
p4 <- p4 + theme(axis.text.x = element_text(angle = 90))
p4 <- p4 + ylab("Zombies Killed")
p4
```

```{r}
library(ggplot2)
p5 <- ggplot(data = d, aes(x = gender, y = age))
p5 <- p5 + geom_boxplot()
p5 <- p5 + theme(axis.text.x = element_text(angle = 90))
p5 <- p5 + ylab("Age")
p5
```

```{r}
library(ggplot2)

scatter<- ggplot(data = d, aes(x = age, y = weight)) 
scatter <- scatter + xlab("Age") + ylab("Weight")
scatter <- scatter + geom_point() 
scatter <- scatter + theme(legend.position = "bottom", legend.title = element_blank())  
scatter 

```
```{r}
scatter1<- ggplot(data = d, aes(x = age, y = height)) 
scatter1 <- scatter1 + xlab("Age") + ylab("Height")
scatter1 <- scatter1 + geom_point() 
scatter1 <- scatter1 + theme(legend.position = "bottom", legend.title = element_blank())  
scatter1 
```

```{r}
par(mfrow = c(2, 3))  #two panels
attach(d)
hist(muh, freq = FALSE, col = "purple", main = "Height")
hist(muw, freq = FALSE, col = "purple", main = "Weight")
hist(muy, freq = FALSE, col = "purple", main = "Years of Education")
hist(muz, freq = FALSE, col = "purple", main = "Zombies killed")
hist(mua, freq = FALSE, col = "purple", main = "Age")

#years of education and zombies killed do not follow the normal distribution. This makes sense as they are count data and should follow the Poisson distribution. 
```
```{r}
attach(d)
par(mfrow = c(2,3))
qqnorm(muh, main = "Q-Q Plot", xlab = "Height", plot.it = TRUE, datax = FALSE)
qqnorm(muw, main = "Q-Q Plot", xlab = "Weight", plot.it = TRUE, datax = FALSE)
qqnorm(muy, main = "Q-Q Plot", xlab = "Years", plot.it = TRUE, datax = FALSE)
qqnorm(muz, main = "Q-Q Plot", xlab = "Zombies", plot.it = TRUE, datax = FALSE)
qqnorm(mua, main = "Q-Q Plot", xlab = "Age", plot.it = TRUE, datax = FALSE)
```

```{r}
s<-d[sample(nrow(d), 30, replace = FALSE, prob = NULL), ]
#if replace = FALSE after () add , and one space close brackets
s
```
```{r}
sm<-s$height
m <- mean(sm)
m
n <- length(sm)
n
v <- var(sm)
v
s <- sd(sm)
s
e <- sqrt(v/n)
e
upper <- mean(sm) + qnorm(0.975, mean = mean(sm), sd = sd(sm)) * e
lower <- mean(sm) - qnorm(0.025, mean = mean(sm), sd = sd(sm)) * e   
ci <- c(lower, upper)
ci
```
```{r}
sw <- s$weight
m1 <- mean(sw)
m1
n1 <- length(sw)
n1
v1 <- var(sw)
v1
s1 <- sd(sw)
s1
e1 <- sqrt(v/n)
e1
upper1 <- mean(sw) + qnorm(0.975, mean = mean(sw), sd = sd(sw)) * e1
lower1 <- mean(sw) - qnorm(0.025, mean = mean(sw), sd = sd(sw)) * e1
ci1 <- c(lower1, upper1)
ci1
```
```{r}
sy<-s$years_of_education
#poisson not normal
m4 <- mean(sy)
m4
l1 <- (sum(sy)/ 30)
l1
n4 <- length(sy)
n4
e4 <- sqrt(l1/n4)
e4
upper4 <- l + 1.96*e4 
lower4 <- l - 1.96*e4 
lower4
upper4
```
```{r}
sz<-s$zombies_killed
#poisson not normal
m3<-mean(sz)
m3
l<-(sum(sz)/ 30) #l is equal to number of events divided by units in data
l
n3<- length(sz)
n3
e3<- sqrt(l/n3)
e3
upper3<- l + 1.96*e3
lower3<- l - 1.96*e3
lower3 
upper3

```

```{r}
sa<-s$age
m2 <- mean(sa)
m2
n2 <- length(sa)
n2
v2 <- var(sa)
v2
s2 <- sd(sa)
s2
e2 <- sqrt(v/n)
e2
upper2 <- mean(sa) + qnorm(0.975, mean = mean(sa), sd = sd(sa)) * e2
lower2 <- mean(sa) - qnorm(0.025, mean = mean(sa), sd = sd(sa)) * e2
ci2 <- c(lower2, upper2)
ci2
```
```{r}
attach(d)
k <- 99  # number of samples
n <- 30  # size of each sample
s99 <- NULL  # dummy variable to hold each sample
for (i in 1:k) {
    s99[[i]] <- sample(d, size = n, replace = TRUE)
}
head(s99)
```

```{r}
m <- NULL
for(i in 1:k) {
  m[[i]] <- mean(s99[[i]][ ,"weight"])
}
```
